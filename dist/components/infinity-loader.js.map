{"version":3,"file":"infinity-loader.js","sources":["../../src/components/infinity-loader.hbs","../../src/components/infinity-loader.js"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{#if this.shouldShow}}\\n  <div\\n    {{did-insert this.didInsertLoader this}}\\n    {{did-update this._initialInfinityModelSetup @infinityModel}}\\n    {{did-update this._loadStatusDidChange @hideOnInfinity}}\\n    {{did-update this._loadStatusDidChange @reachedInfinity}}\\n    class=\\\"{{this.loaderClassNames}}{{if this.viewportEntered \\' in-viewport\\'}}{{if\\n        this.isDoneLoading\\n        \\' reached-infinity\\'\\n      }}\\\"\\n    data-test-infinity-loader\\n  >\\n    {{#if (has-block)}}\\n      {{yield this.infinityModelContent}}\\n    {{else}}\\n      {{#if this.isDoneLoading}}\\n        <span>{{this.loadedText}}</span>\\n      {{else}}\\n        <span>{{this.loadingText}}</span>\\n      {{/if}}\\n    {{/if}}\\n  </div>\\n{{/if}}\")","import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { cancel, debounce } from '@ember/runloop';\nimport { set, action } from '@ember/object';\nimport { inject as service } from '@ember/service';\n\nexport default class InfinityLoaderComponent extends Component {\n  @service infinity;\n  @service inViewport;\n\n  @tracked _loadingText;\n  @tracked _loadedText;\n  @tracked _isDoneLoading;\n  @tracked _shouldShow;\n\n  /**\n   * @public\n   * @property eventDebounce\n   * @default 50\n   */\n  get eventDebounce() {\n    return this.args.eventDebounce ?? 50;\n  }\n  /**\n   * @public\n   * @property loadingText\n   */\n  get loadingText() {\n    return (\n      this._loadingText ||\n      (this.args.loadingText ?? 'Loading Infinity Model...')\n    );\n  }\n\n  set loadingText(value) {\n    this._loadingText = value;\n  }\n  /**\n   * @public\n   * @property loadedText\n   */\n  get loadedText() {\n    return (\n      this._loadedText ||\n      (this.args.loadedText ?? 'Infinity Model Entirely Loaded.')\n    );\n  }\n\n  set loadedText(value) {\n    this._loadedText = value;\n  }\n  /**\n   * @public\n   * @property hideOnInfinity\n   * @default false\n   */\n  get hideOnInfinity() {\n    return this.args.hideOnInfinity ?? false;\n  }\n  /**\n   * @public\n   * @property isDoneLoading\n   * @default false\n   */\n  get isDoneLoading() {\n    return this._isDoneLoading ?? this.args.isDoneLoading ?? false;\n  }\n\n  set isDoneLoading(value) {\n    this._isDoneLoading = value;\n  }\n  /**\n   * @public\n   * @property developmentMode\n   * @default false\n   */\n  get developmentMode() {\n    return this.args.developmentMode ?? false;\n  }\n  /**\n   * indicate to infinity-loader to load previous page\n   *\n   * @public\n   * @property loadPrevious\n   * @default false\n   */\n  get loadPrevious() {\n    return this.args.loadPrevious ?? false;\n  }\n  /**\n   * set if have scrollable area\n   *\n   * @public\n   * @property scrollable\n   */\n  get scrollable() {\n    return this.args.scrollable ?? null;\n  }\n  /**\n   * offset from bottom of target and viewport\n   *\n   * @public\n   * @property triggerOffset\n   * @defaul 0\n   */\n  get triggerOffset() {\n    return this.args.triggerOffset ?? 0;\n  }\n  /**\n   * flag to show/hide the component\n   *\n   * @property shouldShow\n   */\n  get shouldShow() {\n    return this._shouldShow ?? this.args.shouldShow ?? true;\n  }\n\n  set shouldShow(value) {\n    this._shouldShow = value;\n  }\n\n  get loaderClassNames() {\n    return 'infinity-loader '.concat(this.args.classNames || '').trim();\n  }\n\n  get infinityModelContent() {\n    return Promise.resolve(this.args.infinityModel);\n  }\n\n  constructor() {\n    super(...arguments);\n\n    this._initialInfinityModelSetup();\n  }\n\n  /**\n   * setup ember-in-viewport properties\n   *\n   * @method didInsertElement\n   */\n  didInsertLoader(element, [instance]) {\n    /**\n     * @public\n     * @property loadingText\n     */\n    instance.loadingText = instance.loadingText || 'Loading Infinity Model...';\n    /**\n     * @public\n     * @property loadedText\n     */\n    instance.loadedText =\n      instance.loadedText || 'Infinity Model Entirely Loaded.';\n\n    instance.elem = element;\n\n    const options = {\n      viewportSpy: true,\n      viewportTolerance: {\n        top: 0,\n        right: 0,\n        bottom: instance.triggerOffset,\n        left: 0,\n      },\n      scrollableArea: instance.scrollable,\n    };\n    const { onEnter, onExit } = instance.inViewport.watchElement(\n      element,\n      options\n    );\n\n    onEnter(instance.didEnterViewport.bind(instance));\n    onExit(instance.didExitViewport.bind(instance));\n  }\n\n  willDestroy() {\n    super.willDestroy(...arguments);\n    this._cancelTimers();\n\n    this.infinityModelContent.then((infinityModel) => {\n      if (!this.isDestroyed && !this.isDestroying) {\n        infinityModel.off(\n          'infinityModelLoaded',\n          this,\n          this._loadStatusDidChange.bind(this)\n        );\n      }\n    });\n\n    // this.removeObserver('infinityModel', this, this._initialInfinityModelSetup);\n    // this.removeObserver('hideOnInfinity', this, this._loadStatusDidChange);\n    // this.removeObserver('reachedInfinity', this, this._loadStatusDidChange);\n  }\n\n  /**\n   * https://github.com/DockYard/ember-in-viewport#didenterviewport-didexitviewport\n   *\n   * @method didEnterViewport\n   */\n  didEnterViewport() {\n    if (\n      this.developmentMode ||\n      typeof FastBoot !== 'undefined' ||\n      this.isDestroying ||\n      this.isDestroyed\n    ) {\n      return false;\n    }\n\n    if (this.loadPrevious) {\n      return this._debounceScrolledToTop();\n    }\n    return this._debounceScrolledToBottom();\n  }\n\n  /**\n   * https://github.com/DockYard/ember-in-viewport#didenterviewport-didexitviewport\n   *\n   * @method didExitViewport\n   */\n  didExitViewport() {\n    this._cancelTimers();\n  }\n\n  /**\n   * @method _initialInfinityModelSetup\n   */\n  @action\n  _initialInfinityModelSetup() {\n    this.infinityModelContent.then((infinityModel) => {\n      if (this.isDestroyed || this.isDestroying) {\n        return;\n      }\n\n      infinityModel.on(\n        'infinityModelLoaded',\n        this._loadStatusDidChange.bind(this)\n      );\n      set(infinityModel, '_scrollable', this.scrollable);\n      this.isDoneLoading = false;\n      if (!this.hideOnInfinity) {\n        this.shouldShow = true;\n      }\n      this._loadStatusDidChange();\n    });\n  }\n\n  /**\n   * @method _loadStatusDidChange\n   */\n  @action\n  _loadStatusDidChange() {\n    this.infinityModelContent.then((infinityModel) => {\n      if (this.isDestroyed || this.isDestroying) {\n        return;\n      }\n\n      if (infinityModel.reachedInfinity) {\n        this.isDoneLoading = true;\n\n        if (this.hideOnInfinity) {\n          this.shouldShow = false;\n        }\n      } else {\n        this.shouldShow = true;\n      }\n    });\n  }\n\n  /**\n   * only load previous page if route started on a page greater than 1 && currentPage is > 0\n   *\n   * @method _debounceScrolledToTop\n   */\n  _debounceScrolledToTop() {\n    /*\n     This debounce is needed when there is not enough delay between onScrolledToBottom calls.\n     Without this debounce, all rows will be rendered causing immense performance problems\n     */\n    function loadPreviousPage(content) {\n      if (typeof this.infinityLoad === 'function') {\n        // closure action\n        return this.infinityLoad(content, -1);\n      } else {\n        this.infinity.infinityLoad(content, -1);\n      }\n    }\n\n    this.infinityModelContent.then((content) => {\n      if (content.firstPage > 1 && content.currentPage > 0) {\n        this._debounceTimer = debounce(\n          this,\n          loadPreviousPage,\n          content,\n          this.eventDebounce\n        );\n      }\n    });\n  }\n\n  /**\n   * @method _debounceScrolledToBottom\n   */\n  _debounceScrolledToBottom() {\n    /*\n     This debounce is needed when there is not enough delay between onScrolledToBottom calls.\n     Without this debounce, all rows will be rendered causing immense performance problems\n     */\n    function loadMore() {\n      // resolve to create thennable\n      // type is <InfinityModel|Promise|null>\n      this.infinityModelContent.then((content) => {\n        if (typeof this.infinityLoad === 'function') {\n          // closure action (if you need to perform some other logic)\n          return this.infinityLoad(content);\n        } else {\n          // service action\n          this.infinity.infinityLoad(content, 1).then(() => {\n            if (content.canLoadMore) {\n              this._checkScrollableHeight();\n            }\n          });\n        }\n      });\n    }\n    this._debounceTimer = debounce(this, loadMore, this.eventDebounce);\n  }\n\n  /**\n   * recursive function to fill page with records\n   *\n   * @method _checkScrollableHeight\n   */\n  _checkScrollableHeight() {\n    if (this.isDestroying || this.isDestroyed) {\n      return false;\n    }\n    if (this._viewportBottom() > this.elem.getBoundingClientRect().top) {\n      // load again\n      this._debounceScrolledToBottom();\n    }\n  }\n\n  /**\n   * @method _cancelTimers\n   */\n  _cancelTimers() {\n    cancel(this._debounceTimer);\n  }\n\n  /**\n    calculate the bottom of the viewport\n\n    @private\n    @method _viewportBottom\n    @return Integer\n   */\n  _viewportBottom() {\n    if (typeof FastBoot === 'undefined') {\n      const isScrollable = !!this.scrollable;\n      const viewportElem = isScrollable\n        ? document.querySelector(this.scrollable)\n        : window;\n      return isScrollable\n        ? viewportElem.getBoundingClientRect().bottom\n        : viewportElem.innerHeight;\n    }\n  }\n}\n"],"names":["InfinityLoaderComponent","_class","Component","eventDebounce","args","loadingText","_loadingText","value","loadedText","_loadedText","hideOnInfinity","isDoneLoading","_isDoneLoading","developmentMode","loadPrevious","scrollable","triggerOffset","shouldShow","_shouldShow","loaderClassNames","concat","classNames","trim","infinityModelContent","Promise","resolve","infinityModel","constructor","arguments","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_initialInfinityModelSetup","didInsertLoader","element","instance","elem","options","viewportSpy","viewportTolerance","top","right","bottom","left","scrollableArea","onEnter","onExit","inViewport","watchElement","didEnterViewport","bind","didExitViewport","willDestroy","_cancelTimers","then","isDestroyed","isDestroying","off","_loadStatusDidChange","FastBoot","_debounceScrolledToTop","_debounceScrolledToBottom","on","set","reachedInfinity","loadPreviousPage","content","infinityLoad","infinity","firstPage","currentPage","_debounceTimer","debounce","loadMore","canLoadMore","_checkScrollableHeight","_viewportBottom","getBoundingClientRect","cancel","isScrollable","viewportElem","document","querySelector","window","innerHeight","_applyDecoratedDescriptor","prototype","service","configurable","enumerable","writable","initializer","tracked","action","Object","getOwnPropertyDescriptor","setComponentTemplate","TEMPLATE"],"mappings":";;;;;;;;;AACA,eAAe,kBAAkB,CAAC,ytBAAytB;;;ACKtuBA,IAAAA,uBAAuB,IAAAC,MAAA,GAA7B,MAAMD,uBAAuB,SAASE,SAAS,CAAC;AAS7D;AACF;AACA;AACA;AACA;EACE,IAAIC,aAAaA,GAAG;AAClB,IAAA,OAAO,IAAI,CAACC,IAAI,CAACD,aAAa,IAAI,EAAE,CAAA;AACtC,GAAA;AACA;AACF;AACA;AACA;EACE,IAAIE,WAAWA,GAAG;IAChB,OACE,IAAI,CAACC,YAAY,KAChB,IAAI,CAACF,IAAI,CAACC,WAAW,IAAI,2BAA2B,CAAC,CAAA;AAE1D,GAAA;EAEA,IAAIA,WAAWA,CAACE,KAAK,EAAE;IACrB,IAAI,CAACD,YAAY,GAAGC,KAAK,CAAA;AAC3B,GAAA;AACA;AACF;AACA;AACA;EACE,IAAIC,UAAUA,GAAG;IACf,OACE,IAAI,CAACC,WAAW,KACf,IAAI,CAACL,IAAI,CAACI,UAAU,IAAI,iCAAiC,CAAC,CAAA;AAE/D,GAAA;EAEA,IAAIA,UAAUA,CAACD,KAAK,EAAE;IACpB,IAAI,CAACE,WAAW,GAAGF,KAAK,CAAA;AAC1B,GAAA;AACA;AACF;AACA;AACA;AACA;EACE,IAAIG,cAAcA,GAAG;AACnB,IAAA,OAAO,IAAI,CAACN,IAAI,CAACM,cAAc,IAAI,KAAK,CAAA;AAC1C,GAAA;AACA;AACF;AACA;AACA;AACA;EACE,IAAIC,aAAaA,GAAG;IAClB,OAAO,IAAI,CAACC,cAAc,IAAI,IAAI,CAACR,IAAI,CAACO,aAAa,IAAI,KAAK,CAAA;AAChE,GAAA;EAEA,IAAIA,aAAaA,CAACJ,KAAK,EAAE;IACvB,IAAI,CAACK,cAAc,GAAGL,KAAK,CAAA;AAC7B,GAAA;AACA;AACF;AACA;AACA;AACA;EACE,IAAIM,eAAeA,GAAG;AACpB,IAAA,OAAO,IAAI,CAACT,IAAI,CAACS,eAAe,IAAI,KAAK,CAAA;AAC3C,GAAA;AACA;AACF;AACA;AACA;AACA;AACA;AACA;EACE,IAAIC,YAAYA,GAAG;AACjB,IAAA,OAAO,IAAI,CAACV,IAAI,CAACU,YAAY,IAAI,KAAK,CAAA;AACxC,GAAA;AACA;AACF;AACA;AACA;AACA;AACA;EACE,IAAIC,UAAUA,GAAG;AACf,IAAA,OAAO,IAAI,CAACX,IAAI,CAACW,UAAU,IAAI,IAAI,CAAA;AACrC,GAAA;AACA;AACF;AACA;AACA;AACA;AACA;AACA;EACE,IAAIC,aAAaA,GAAG;AAClB,IAAA,OAAO,IAAI,CAACZ,IAAI,CAACY,aAAa,IAAI,CAAC,CAAA;AACrC,GAAA;AACA;AACF;AACA;AACA;AACA;EACE,IAAIC,UAAUA,GAAG;IACf,OAAO,IAAI,CAACC,WAAW,IAAI,IAAI,CAACd,IAAI,CAACa,UAAU,IAAI,IAAI,CAAA;AACzD,GAAA;EAEA,IAAIA,UAAUA,CAACV,KAAK,EAAE;IACpB,IAAI,CAACW,WAAW,GAAGX,KAAK,CAAA;AAC1B,GAAA;EAEA,IAAIY,gBAAgBA,GAAG;AACrB,IAAA,OAAO,kBAAkB,CAACC,MAAM,CAAC,IAAI,CAAChB,IAAI,CAACiB,UAAU,IAAI,EAAE,CAAC,CAACC,IAAI,EAAE,CAAA;AACrE,GAAA;EAEA,IAAIC,oBAAoBA,GAAG;IACzB,OAAOC,OAAO,CAACC,OAAO,CAAC,IAAI,CAACrB,IAAI,CAACsB,aAAa,CAAC,CAAA;AACjD,GAAA;AAEAC,EAAAA,WAAWA,GAAG;IACZ,KAAK,CAAC,GAAGC,SAAS,CAAC,CAAA;AAACC,IAAAA,0BAAA,mBAAAC,WAAA,EAAA,IAAA,CAAA,CAAA;AAAAD,IAAAA,0BAAA,qBAAAE,YAAA,EAAA,IAAA,CAAA,CAAA;AAAAF,IAAAA,0BAAA,uBAAAG,YAAA,EAAA,IAAA,CAAA,CAAA;AAAAH,IAAAA,0BAAA,sBAAAI,YAAA,EAAA,IAAA,CAAA,CAAA;AAAAJ,IAAAA,0BAAA,yBAAAK,YAAA,EAAA,IAAA,CAAA,CAAA;AAAAL,IAAAA,0BAAA,sBAAAM,YAAA,EAAA,IAAA,CAAA,CAAA;IAEpB,IAAI,CAACC,0BAA0B,EAAE,CAAA;AACnC,GAAA;;AAEA;AACF;AACA;AACA;AACA;AACEC,EAAAA,eAAeA,CAACC,OAAO,EAAE,CAACC,QAAQ,CAAC,EAAE;AACnC;AACJ;AACA;AACA;AACIA,IAAAA,QAAQ,CAAClC,WAAW,GAAGkC,QAAQ,CAAClC,WAAW,IAAI,2BAA2B,CAAA;AAC1E;AACJ;AACA;AACA;AACIkC,IAAAA,QAAQ,CAAC/B,UAAU,GACjB+B,QAAQ,CAAC/B,UAAU,IAAI,iCAAiC,CAAA;IAE1D+B,QAAQ,CAACC,IAAI,GAAGF,OAAO,CAAA;AAEvB,IAAA,MAAMG,OAAO,GAAG;AACdC,MAAAA,WAAW,EAAE,IAAI;AACjBC,MAAAA,iBAAiB,EAAE;AACjBC,QAAAA,GAAG,EAAE,CAAC;AACNC,QAAAA,KAAK,EAAE,CAAC;QACRC,MAAM,EAAEP,QAAQ,CAACvB,aAAa;AAC9B+B,QAAAA,IAAI,EAAE,CAAA;OACP;MACDC,cAAc,EAAET,QAAQ,CAACxB,UAAAA;KAC1B,CAAA;IACD,MAAM;MAAEkC,OAAO;AAAEC,MAAAA,MAAAA;KAAQ,GAAGX,QAAQ,CAACY,UAAU,CAACC,YAAY,CAC1Dd,OAAO,EACPG,OACF,CAAC,CAAA;IAEDQ,OAAO,CAACV,QAAQ,CAACc,gBAAgB,CAACC,IAAI,CAACf,QAAQ,CAAC,CAAC,CAAA;IACjDW,MAAM,CAACX,QAAQ,CAACgB,eAAe,CAACD,IAAI,CAACf,QAAQ,CAAC,CAAC,CAAA;AACjD,GAAA;AAEAiB,EAAAA,WAAWA,GAAG;AACZ,IAAA,KAAK,CAACA,WAAW,CAAC,GAAG5B,SAAS,CAAC,CAAA;IAC/B,IAAI,CAAC6B,aAAa,EAAE,CAAA;AAEpB,IAAA,IAAI,CAAClC,oBAAoB,CAACmC,IAAI,CAAEhC,aAAa,IAAK;MAChD,IAAI,CAAC,IAAI,CAACiC,WAAW,IAAI,CAAC,IAAI,CAACC,YAAY,EAAE;AAC3ClC,QAAAA,aAAa,CAACmC,GAAG,CACf,qBAAqB,EACrB,IAAI,EACJ,IAAI,CAACC,oBAAoB,CAACR,IAAI,CAAC,IAAI,CACrC,CAAC,CAAA;AACH,OAAA;AACF,KAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACF,GAAA;;AAEA;AACF;AACA;AACA;AACA;AACED,EAAAA,gBAAgBA,GAAG;AACjB,IAAA,IACE,IAAI,CAACxC,eAAe,IACpB,OAAOkD,QAAQ,KAAK,WAAW,IAC/B,IAAI,CAACH,YAAY,IACjB,IAAI,CAACD,WAAW,EAChB;AACA,MAAA,OAAO,KAAK,CAAA;AACd,KAAA;IAEA,IAAI,IAAI,CAAC7C,YAAY,EAAE;AACrB,MAAA,OAAO,IAAI,CAACkD,sBAAsB,EAAE,CAAA;AACtC,KAAA;AACA,IAAA,OAAO,IAAI,CAACC,yBAAyB,EAAE,CAAA;AACzC,GAAA;;AAEA;AACF;AACA;AACA;AACA;AACEV,EAAAA,eAAeA,GAAG;IAChB,IAAI,CAACE,aAAa,EAAE,CAAA;AACtB,GAAA;;AAEA;AACF;AACA;AAEErB,EAAAA,0BAA0BA,GAAG;AAC3B,IAAA,IAAI,CAACb,oBAAoB,CAACmC,IAAI,CAAEhC,aAAa,IAAK;AAChD,MAAA,IAAI,IAAI,CAACiC,WAAW,IAAI,IAAI,CAACC,YAAY,EAAE;AACzC,QAAA,OAAA;AACF,OAAA;AAEAlC,MAAAA,aAAa,CAACwC,EAAE,CACd,qBAAqB,EACrB,IAAI,CAACJ,oBAAoB,CAACR,IAAI,CAAC,IAAI,CACrC,CAAC,CAAA;MACDa,GAAG,CAACzC,aAAa,EAAE,aAAa,EAAE,IAAI,CAACX,UAAU,CAAC,CAAA;MAClD,IAAI,CAACJ,aAAa,GAAG,KAAK,CAAA;AAC1B,MAAA,IAAI,CAAC,IAAI,CAACD,cAAc,EAAE;QACxB,IAAI,CAACO,UAAU,GAAG,IAAI,CAAA;AACxB,OAAA;MACA,IAAI,CAAC6C,oBAAoB,EAAE,CAAA;AAC7B,KAAC,CAAC,CAAA;AACJ,GAAA;;AAEA;AACF;AACA;AAEEA,EAAAA,oBAAoBA,GAAG;AACrB,IAAA,IAAI,CAACvC,oBAAoB,CAACmC,IAAI,CAAEhC,aAAa,IAAK;AAChD,MAAA,IAAI,IAAI,CAACiC,WAAW,IAAI,IAAI,CAACC,YAAY,EAAE;AACzC,QAAA,OAAA;AACF,OAAA;MAEA,IAAIlC,aAAa,CAAC0C,eAAe,EAAE;QACjC,IAAI,CAACzD,aAAa,GAAG,IAAI,CAAA;QAEzB,IAAI,IAAI,CAACD,cAAc,EAAE;UACvB,IAAI,CAACO,UAAU,GAAG,KAAK,CAAA;AACzB,SAAA;AACF,OAAC,MAAM;QACL,IAAI,CAACA,UAAU,GAAG,IAAI,CAAA;AACxB,OAAA;AACF,KAAC,CAAC,CAAA;AACJ,GAAA;;AAEA;AACF;AACA;AACA;AACA;AACE+C,EAAAA,sBAAsBA,GAAG;AACvB;AACJ;AACA;AACA;IACI,SAASK,gBAAgBA,CAACC,OAAO,EAAE;AACjC,MAAA,IAAI,OAAO,IAAI,CAACC,YAAY,KAAK,UAAU,EAAE;AAC3C;QACA,OAAO,IAAI,CAACA,YAAY,CAACD,OAAO,EAAE,CAAC,CAAC,CAAC,CAAA;AACvC,OAAC,MAAM;QACL,IAAI,CAACE,QAAQ,CAACD,YAAY,CAACD,OAAO,EAAE,CAAC,CAAC,CAAC,CAAA;AACzC,OAAA;AACF,KAAA;AAEA,IAAA,IAAI,CAAC/C,oBAAoB,CAACmC,IAAI,CAAEY,OAAO,IAAK;MAC1C,IAAIA,OAAO,CAACG,SAAS,GAAG,CAAC,IAAIH,OAAO,CAACI,WAAW,GAAG,CAAC,EAAE;AACpD,QAAA,IAAI,CAACC,cAAc,GAAGC,QAAQ,CAC5B,IAAI,EACJP,gBAAgB,EAChBC,OAAO,EACP,IAAI,CAACnE,aACP,CAAC,CAAA;AACH,OAAA;AACF,KAAC,CAAC,CAAA;AACJ,GAAA;;AAEA;AACF;AACA;AACE8D,EAAAA,yBAAyBA,GAAG;AAC1B;AACJ;AACA;AACA;IACI,SAASY,QAAQA,GAAG;AAClB;AACA;AACA,MAAA,IAAI,CAACtD,oBAAoB,CAACmC,IAAI,CAAEY,OAAO,IAAK;AAC1C,QAAA,IAAI,OAAO,IAAI,CAACC,YAAY,KAAK,UAAU,EAAE;AAC3C;AACA,UAAA,OAAO,IAAI,CAACA,YAAY,CAACD,OAAO,CAAC,CAAA;AACnC,SAAC,MAAM;AACL;AACA,UAAA,IAAI,CAACE,QAAQ,CAACD,YAAY,CAACD,OAAO,EAAE,CAAC,CAAC,CAACZ,IAAI,CAAC,MAAM;YAChD,IAAIY,OAAO,CAACQ,WAAW,EAAE;cACvB,IAAI,CAACC,sBAAsB,EAAE,CAAA;AAC/B,aAAA;AACF,WAAC,CAAC,CAAA;AACJ,SAAA;AACF,OAAC,CAAC,CAAA;AACJ,KAAA;AACA,IAAA,IAAI,CAACJ,cAAc,GAAGC,QAAQ,CAAC,IAAI,EAAEC,QAAQ,EAAE,IAAI,CAAC1E,aAAa,CAAC,CAAA;AACpE,GAAA;;AAEA;AACF;AACA;AACA;AACA;AACE4E,EAAAA,sBAAsBA,GAAG;AACvB,IAAA,IAAI,IAAI,CAACnB,YAAY,IAAI,IAAI,CAACD,WAAW,EAAE;AACzC,MAAA,OAAO,KAAK,CAAA;AACd,KAAA;AACA,IAAA,IAAI,IAAI,CAACqB,eAAe,EAAE,GAAG,IAAI,CAACxC,IAAI,CAACyC,qBAAqB,EAAE,CAACrC,GAAG,EAAE;AAClE;MACA,IAAI,CAACqB,yBAAyB,EAAE,CAAA;AAClC,KAAA;AACF,GAAA;;AAEA;AACF;AACA;AACER,EAAAA,aAAaA,GAAG;AACdyB,IAAAA,MAAM,CAAC,IAAI,CAACP,cAAc,CAAC,CAAA;AAC7B,GAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AAEEK,EAAAA,eAAeA,GAAG;AAChB,IAAA,IAAI,OAAOjB,QAAQ,KAAK,WAAW,EAAE;AACnC,MAAA,MAAMoB,YAAY,GAAG,CAAC,CAAC,IAAI,CAACpE,UAAU,CAAA;AACtC,MAAA,MAAMqE,YAAY,GAAGD,YAAY,GAC7BE,QAAQ,CAACC,aAAa,CAAC,IAAI,CAACvE,UAAU,CAAC,GACvCwE,MAAM,CAAA;AACV,MAAA,OAAOJ,YAAY,GACfC,YAAY,CAACH,qBAAqB,EAAE,CAACnC,MAAM,GAC3CsC,YAAY,CAACI,WAAW,CAAA;AAC9B,KAAA;AACF,GAAA;AACF,CAAC,GAAA1D,WAAA,GAAA2D,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,EAAA,UAAA,EAAA,CAxWEC,MAAO,CAAA,EAAA;EAAAC,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAAhE,CAAAA,EAAAA,YAAA,GAAA0D,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,iBACPC,MAAO,CAAA,EAAA;EAAAC,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA/D,CAAAA,EAAAA,YAAA,GAAAyD,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,mBAEPM,OAAO,CAAA,EAAA;EAAAJ,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA9D,CAAAA,EAAAA,YAAA,GAAAwD,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,kBACPM,OAAO,CAAA,EAAA;EAAAJ,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA7D,CAAAA,EAAAA,YAAA,GAAAuD,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,qBACPM,OAAO,CAAA,EAAA;EAAAJ,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA5D,CAAAA,EAAAA,YAAA,GAAAsD,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,kBACPM,OAAO,CAAA,EAAA;EAAAJ,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA,CAAA,EAAAN,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,EAAA,4BAAA,EAAA,CAqNPO,MAAM,CAAAC,EAAAA,MAAA,CAAAC,wBAAA,CAAAlG,MAAA,CAAAyF,SAAA,EAAAzF,4BAAAA,CAAAA,EAAAA,MAAA,CAAAyF,SAAA,CAAA,EAAAD,yBAAA,CAAAxF,MAAA,CAAAyF,SAAA,2BAuBNO,MAAM,CAAA,EAAAC,MAAA,CAAAC,wBAAA,CAAAlG,MAAA,CAAAyF,SAAA,EAAA,sBAAA,CAAA,EAAAzF,MAAA,CAAAyF,SAAA,IAAAzF,MAAA,EAAA;AAnPmCmG,oBAAA,CAAAC,QAAA,EAAvBrG,uBAAuB,CAAA;;;;"}